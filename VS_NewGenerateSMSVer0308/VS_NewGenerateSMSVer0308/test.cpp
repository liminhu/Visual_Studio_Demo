#include "stdafx.h"
#include "test.h"

int test1_sub_9C024(){
	char *a1_hex = "800000000000000000000000000000000000000000000000";
	char *a1 = hexStringToString(a1_hex, strlen(a1_hex));
	int a1_len = 0x18;
	char *key_hex = "1D3DC5ED060F2BF94B8DF30628A203B88E32E18E21F7AF48BE23FB635B31EDBD000300000000000071C1C00BBFB521B75843FB768A07EE41575870F6D48A586A23ADCBF1A9AF7E565C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C70000000BB03000058F950";
	char *key = hexStringToString(key_hex, strlen(key_hex));
	int key_len =40+64;
	sub_9C024(a1, a1_len, key, key_len);
	printf("\nfirst 9C024 after:\n");
	printfOutResult((unsigned char *)key, key_len);
	char *a2_hex = "0000000000000300";
	char *a2 = hexStringToString(a2_hex, strlen(a2_hex));
	int a2_len = 0x8;
	sub_9C024(a2, a2_len, key, key_len);
	printfOutResult((unsigned char *)key, key_len);
	return 0;
}



int test1_sub_90928(){
	char *key_hex = "1D3DC5ED060F2BF94B8DF30628A203B88E32E18E21F7AF48BE23FB635B31EDBD000300000000000071C1C00BBFB521B75843FB768A07EE41575870F6D48A586A23ADCBF1A9AF7E565C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C";
	char *key = hexStringToString(key_hex, strlen(key_hex));
	return 0;
}




int  Cid_md5_2B128(char *a1, char *a2){
	void *v2; // r12@1
	char *v3; // ST20_4@1
	int v4; // ST24_4@1
	int v5; // ST28_4@1
	int v6; // ST2C_4@1
	int v7; // ST30_4@1
	int v8; // ST34_4@1
	int v9; // ST38_4@1
	int v10; // ST3C_4@1
	int v11; // ST40_4@1
	int v12; // ST44_4@1
	int v13; // ST48_4@1
	int v14; // ST4C_4@1
	int v15; // ST50_4@1
	int v16; // ST54_4@1
	int v17; // ST58_4@1
	int v18; // ST5C_4@1
	int v19; // ST60_4@1
	int v20; // ST18_4@1
	int v21; // ST14_4@1
	int v22; // ST10_4@1
	int v23; // r0@1
	int v24; // ST0C_4@1
	int v25; // r0@1
	int v26; // off@1
	int v27; // ST18_4@1
	int v28; // r0@1
	int v29; // off@1
	int v30; // ST0C_4@1
	int v31; // r0@1
	int v32; // off@1
	int v33; // ST10_4@1
	int v34; // r0@1
	int v35; // off@1
	int v36; // ST14_4@1
	int v37; // r0@1
	int v38; // off@1
	int v39; // ST18_4@1
	int v40; // r0@1
	int v41; // off@1
	int v42; // ST0C_4@1
	int v43; // r0@1
	int v44; // off@1
	int v45; // ST10_4@1
	int v46; // r0@1
	int v47; // off@1
	int v48; // ST14_4@1
	int v49; // r0@1
	int v50; // off@1
	int v51; // ST18_4@1
	int v52; // r0@1
	int v53; // off@1
	int v54; // ST0C_4@1
	int v55; // r0@1
	int v56; // off@1
	int v57; // ST10_4@1
	int v58; // r0@1
	int v59; // off@1
	int v60; // ST14_4@1
	int v61; // r0@1
	int v62; // off@1
	int v63; // ST18_4@1
	int v64; // r0@1
	int v65; // off@1
	int v66; // ST0C_4@1
	int v67; // r0@1
	int v68; // off@1
	int v69; // ST10_4@1
	int v70; // r0@1
	int v71; // off@1
	int v72; // ST14_4@1
	int v73; // r0@1
	int v74; // off@1
	int v75; // ST18_4@1
	int v76; // r0@1
	int v77; // off@1
	int v78; // ST0C_4@1
	int v79; // r0@1
	int v80; // off@1
	int v81; // ST10_4@1
	int v82; // r0@1
	int v83; // off@1
	int v84; // ST14_4@1
	int v85; // r0@1
	int v86; // off@1
	int v87; // ST18_4@1
	int v88; // r0@1
	int v89; // off@1
	int v90; // ST0C_4@1
	int v91; // r0@1
	int v92; // off@1
	int v93; // ST10_4@1
	int v94; // r0@1
	int v95; // off@1
	int v96; // ST14_4@1
	int v97; // r0@1
	int v98; // off@1
	int v99; // ST18_4@1
	int v100; // r0@1
	int v101; // off@1
	int v102; // ST0C_4@1
	int v103; // r0@1
	int v104; // off@1
	int v105; // ST10_4@1
	int v106; // r0@1
	int v107; // off@1
	int v108; // ST14_4@1
	int v109; // r0@1
	int v110; // off@1
	int v111; // ST18_4@1
	int v112; // r0@1
	int v113; // off@1
	int v114; // ST0C_4@1
	int v115; // r0@1
	int v116; // off@1
	int v117; // ST10_4@1
	int v118; // r0@1
	int v119; // off@1
	int v120; // ST14_4@1
	int v121; // r0@1
	int v122; // off@1
	int v123; // ST18_4@1
	int v124; // r0@1
	int v125; // off@1
	int v126; // ST0C_4@1
	int v127; // r0@1
	int v128; // off@1
	int v129; // ST10_4@1
	int v130; // r0@1
	int v131; // off@1
	int v132; // ST14_4@1
	int v133; // r0@1
	int v134; // off@1
	int v135; // ST18_4@1
	int v136; // r0@1
	int v137; // off@1
	int v138; // ST0C_4@1
	int v139; // r0@1
	int v140; // off@1
	int v141; // ST10_4@1
	int v142; // r0@1
	int v143; // off@1
	int v144; // ST14_4@1
	int v145; // r0@1
	int v146; // off@1
	int v147; // ST18_4@1
	int v148; // r0@1
	int v149; // off@1
	int v150; // ST0C_4@1
	int v151; // r0@1
	int v152; // off@1
	int v153; // ST10_4@1
	int v154; // r0@1
	int v155; // off@1
	int v156; // ST14_4@1
	int v157; // r0@1
	int v158; // off@1
	int v159; // ST18_4@1
	int v160; // r0@1
	int v161; // off@1
	int v162; // ST0C_4@1
	int v163; // r0@1
	int v164; // off@1
	int v165; // ST10_4@1
	int v166; // r0@1
	int v167; // off@1
	int v168; // ST14_4@1
	int v169; // r0@1
	int v170; // off@1
	int v171; // ST18_4@1
	int v172; // r0@1
	int v173; // off@1
	int v174; // ST0C_4@1
	int v175; // r0@1
	int v176; // off@1
	int v177; // ST10_4@1
	int v178; // r0@1
	int v179; // off@1
	int v180; // ST14_4@1
	int v181; // r0@1
	int v182; // off@1
	int v183; // ST18_4@1
	int v184; // r0@1
	int v185; // off@1
	int v186; // ST0C_4@1
	int v187; // r0@1
	int v188; // off@1
	int v189; // ST10_4@1
	int v190; // r0@1
	int v191; // off@1
	int v192; // ST14_4@1
	int v193; // r0@1
	int v194; // off@1
	int v195; // ST18_4@1
	int v196; // off@1
	int v197; // ST0C_4@1
	int v198; // r0@1
	int v199; // off@1
	int v200; // ST10_4@1
	int v201; // r0@1
	int v202; // off@1
	int v203; // ST14_4@1
	int v204; // r0@1
	int v205; // off@1
	int v206; // ST18_4@1
	int v207; // r0@1
	int v208; // off@1
	int v209; // ST0C_4@1
	int v210; // r0@1
	int v211; // off@1
	int v212; // off@1
	char* result; // r0@1
	int v214; // [sp+64h] [bp-Ch]@1


	v3 = a1;
	v4 = a2[0] | (a2[1] << 8) | (a2[2] << 16) | (a2[3] << 24);
	v5 = a2[4] | (a2[5] << 8) | (a2[6] << 16) | (a2[7] << 24);
	v6 = a2[8] | (a2[9] << 8) | (a2[10] << 16) | (a2[11] << 24);
	v7 = a2[12] | (a2[13] << 8) | (a2[14] << 16) | (a2[15] << 24);
	v8 = a2[16] | (a2[17] << 8) | (a2[18] << 16) | (a2[19] << 24);
	v9 = a2[20] | (a2[21] << 8) | (a2[22] << 16) | (a2[23] << 24);
	v10 = a2[24] | (a2[25] << 8) | (a2[26] << 16) | (a2[27] << 24);
	v11 = a2[28] | (a2[29] << 8) | (a2[30] << 16) | (a2[31] << 24);
	v12 = a2[32] | (a2[33] << 8) | (a2[34] << 16) | (a2[35] << 24);
	v13 = a2[36] | (a2[37] << 8) | (a2[38] << 16) | (a2[39] << 24);
	v14 = a2[40] | (a2[41] << 8) | (a2[42] << 16) | (a2[43] << 24);
	v15 = a2[44] | (a2[45] << 8) | (a2[46] << 16) | (a2[47] << 24);
	v16 = a2[48] | (a2[49] << 8) | (a2[50] << 16) | (a2[51] << 24);
	v17 = a2[52] | (a2[53] << 8) | (a2[54] << 16) | (a2[55] << 24);
	v18 = a2[56] | (a2[57] << 8) | (a2[58] << 16) | (a2[59] << 24);
	v19 = a2[60] | (a2[61] << 8) | (a2[62] << 16) | (a2[63] << 24);
	v20 = *((int *)a1 + 2);
	v21 = *((int *)a1 + 3);
	v22 = *((int *)a1 + 4);
	v23 = *((int *)a1 + 5);
	v24 = v23;
	v26 = __ROR4__((v23 ^ v21 & (v22 ^ v23)) + v4 + v20 - 0x28955B88, 25);
	v25 = v21 + v26;
	v27 = v25;
	v29 = __ROR4__((v22 ^ (v21 + v26) & (v21 ^ v22)) + v5 + v24 - 0x173848AA, 20);
	v28 = v25 + v29;
	v30 = v28;
	v32 = __ROR4__((v21 ^ v28 & (v27 ^ v21)) + v6 + v22 + 0x242070DB, 15);
	v31 = v28 + v32;
	v33 = v31;
	v35 = __ROR4__((v27 ^ v31 & (v30 ^ v27)) + v7 + v21 - 0x3E423112, 10);
	v34 = v31 + v35;
	v36 = v34;
	v38 = __ROR4__((v30 ^ v34 & (v33 ^ v30)) + v8 + v27 - 176418897, 25);
	v37 = v34 + v38;
	v39 = v37;
	v41 = __ROR4__((v33 ^ v37 & (v36 ^ v33)) + v9 + v30 + 1200080426, 20);
	v40 = v37 + v41;
	v42 = v40;
	v44 = __ROR4__((v36 ^ v40 & (v39 ^ v36)) + v10 + v33 - 1473231341, 15);
	v43 = v40 + v44;
	v45 = v43;
	v47 = __ROR4__((v39 ^ v43 & (v42 ^ v39)) + v11 + v36 - 45705983, 10);
	v46 = v43 + v47;
	v48 = v46;
	v50 = __ROR4__((v42 ^ v46 & (v45 ^ v42)) + v12 + v39 + 1770035416, 25);
	v49 = v46 + v50;
	v51 = v49;
	v53 = __ROR4__((v45 ^ v49 & (v48 ^ v45)) + v13 + v42 - 1958414417, 20);
	v52 = v49 + v53;
	v54 = v52;
	v56 = __ROR4__((v48 ^ v52 & (v51 ^ v48)) + v14 + v45 - 42063, 15);
	v55 = v52 + v56;
	v57 = v55;
	v59 = __ROR4__((v51 ^ v55 & (v54 ^ v51)) + v15 + v48 - 1990404162, 10);
	v58 = v55 + v59;
	v60 = v58;
	v62 = __ROR4__((v54 ^ v58 & (v57 ^ v54)) + v16 + v51 + 1804603682, 25);
	v61 = v58 + v62;
	v63 = v61;
	v65 = __ROR4__((v57 ^ v61 & (v60 ^ v57)) + v17 + v54 - 40341101, 20);
	v64 = v61 + v65;
	v66 = v64;
	v68 = __ROR4__((v60 ^ v64 & (v63 ^ v60)) + v18 + v57 - 1502002290, 15);
	v67 = v64 + v68;
	v69 = v67;
	v71 = __ROR4__((v63 ^ v67 & (v66 ^ v63)) + v19 + v60 + 1236535329, 10);
	v70 = v67 + v71;
	v72 = v70;
	v74 = __ROR4__((v69 ^ v66 & (v70 ^ v69)) + v5 + v63 - 165796510, 27);
	v73 = v70 + v74;
	v75 = v73;
	v77 = __ROR4__((v72 ^ v69 & (v73 ^ v72)) + v10 + v66 - 1069501632, 23);
	v76 = v73 + v77;
	v78 = v76;
	v80 = __ROR4__((v75 ^ v72 & (v76 ^ v75)) + v15 + v69 + 643717713, 18);
	v79 = v76 + v80;
	v81 = v79;
	v83 = __ROR4__((v78 ^ v75 & (v79 ^ v78)) + v4 + v72 - 373897302, 12);
	v82 = v79 + v83;
	v84 = v82;
	v86 = __ROR4__((v81 ^ v78 & (v82 ^ v81)) + v9 + v75 - 701558691, 27);
	v85 = v82 + v86;
	v87 = v85;
	v89 = __ROR4__((v84 ^ v81 & (v85 ^ v84)) + v14 + v78 + 38016083, 23);
	v88 = v85 + v89;
	v90 = v88;
	v92 = __ROR4__((v87 ^ v84 & (v88 ^ v87)) + v19 + v81 - 660478335, 18);
	v91 = v88 + v92;
	v93 = v91;
	v95 = __ROR4__((v90 ^ v87 & (v91 ^ v90)) + v8 + v84 - 405537848, 12);
	v94 = v91 + v95;
	v96 = v94;
	v98 = __ROR4__((v93 ^ v90 & (v94 ^ v93)) + v13 + v87 + 568446438, 27);
	v97 = v94 + v98;
	v99 = v97;
	v101 = __ROR4__((v96 ^ v93 & (v97 ^ v96)) + v18 + v90 - 1019803690, 23);
	v100 = v97 + v101;
	v102 = v100;
	v104 = __ROR4__((v99 ^ v96 & (v100 ^ v99)) + v7 + v93 - 187363961, 18);
	v103 = v100 + v104;
	v105 = v103;
	v107 = __ROR4__((v102 ^ v99 & (v103 ^ v102)) + v12 + v96 + 1163531501, 12);
	v106 = v103 + v107;
	v108 = v106;
	v110 = __ROR4__((v105 ^ v102 & (v106 ^ v105)) + v17 + v99 - 1444681467, 27);
	v109 = v106 + v110;
	v111 = v109;
	v113 = __ROR4__((v108 ^ v105 & (v109 ^ v108)) + v6 + v102 - 51403784, 23);
	v112 = v109 + v113;
	v114 = v112;
	v116 = __ROR4__((v111 ^ v108 & (v112 ^ v111)) + v11 + v105 + 1735328473, 18);
	v115 = v112 + v116;
	v117 = v115;
	v119 = __ROR4__((v114 ^ v111 & (v115 ^ v114)) + v16 + v108 - 1926607734, 12);
	v118 = v115 + v119;
	v120 = v118;
	v122 = __ROR4__((v118 ^ v117 ^ v114) + v9 + v111 - 378558, 28);
	v121 = v118 + v122;
	v123 = v121;
	v125 = __ROR4__((v121 ^ v120 ^ v117) + v12 + v114 - 2022574463, 21);
	v124 = v121 + v125;
	v126 = v124;
	v128 = __ROR4__((v124 ^ v123 ^ v120) + v15 + v117 + 1839030562, 16);
	v127 = v124 + v128;
	v129 = v127;
	v131 = __ROR4__((v127 ^ v126 ^ v123) + v18 + v120 - 35309556, 9);
	v130 = v127 + v131;
	v132 = v130;
	v134 = __ROR4__((v130 ^ v129 ^ v126) + v5 + v123 - 1530992060, 28);
	v133 = v130 + v134;
	v135 = v133;
	v137 = __ROR4__((v133 ^ v132 ^ v129) + v8 + v126 + 1272893353, 21);
	v136 = v133 + v137;
	v138 = v136;
	v140 = __ROR4__((v136 ^ v135 ^ v132) + v11 + v129 - 155497632, 16);
	v139 = v136 + v140;
	v141 = v139;
	v143 = __ROR4__((v139 ^ v138 ^ v135) + v14 + v132 - 1094730640, 9);
	v142 = v139 + v143;
	v144 = v142;
	v146 = __ROR4__((v142 ^ v141 ^ v138) + v17 + v135 + 681279174, 28);
	v145 = v142 + v146;
	v147 = v145;
	v149 = __ROR4__((v145 ^ v144 ^ v141) + v4 + v138 - 358537222, 21);
	v148 = v145 + v149;
	v150 = v148;
	v152 = __ROR4__((v148 ^ v147 ^ v144) + v7 + v141 - 722521979, 16);
	v151 = v148 + v152;
	v153 = v151;
	v155 = __ROR4__((v151 ^ v150 ^ v147) + v10 + v144 + 76029189, 9);
	v154 = v151 + v155;
	v156 = v154;
	v158 = __ROR4__((v154 ^ v153 ^ v150) + v13 + v147 - 640364487, 28);
	v157 = v154 + v158;
	v159 = v157;
	v161 = __ROR4__((v157 ^ v156 ^ v153) + v16 + v150 - 421815835, 21);
	v160 = v157 + v161;
	v162 = v160;
	v164 = __ROR4__((v160 ^ v159 ^ v156) + v19 + v153 + 530742520, 16);
	v163 = v160 + v164;
	v165 = v163;
	v167 = __ROR4__((v163 ^ v162 ^ v159) + v6 + v156 - 995338651, 9);
	v166 = v163 + v167;
	v168 = v166;
	v170 = __ROR4__((v165 ^ (v166 | ~v162)) + v4 + v159 - 198630844, 26);
	v169 = v166 + v170;
	v171 = v169;
	v173 = __ROR4__((v168 ^ (v169 | ~v165)) + v11 + v162 + 1126891415, 22);
	v172 = v169 + v173;
	v174 = v172;
	v176 = __ROR4__((v171 ^ (v172 | ~v168)) + v18 + v165 - 1416354905, 17);
	v175 = v172 + v176;
	v177 = v175;
	v179 = __ROR4__((v174 ^ (v175 | ~v171)) + v9 + v168 - 57434055, 11);
	v178 = v175 + v179;
	v180 = v178;
	v182 = __ROR4__((v177 ^ (v178 | ~v174)) + v16 + v171 + 1700485571, 26);
	v181 = v178 + v182;
	v183 = v181;
	v185 = __ROR4__((v180 ^ (v181 | ~v177)) + v7 + v174 - 1894986606, 22);
	v184 = v181 + v185;
	v186 = v184;
	v188 = __ROR4__((v183 ^ (v184 | ~v180)) + v14 + v177 - 1051523, 17);
	v187 = v184 + v188;
	v189 = v187;
	v191 = __ROR4__((v186 ^ (v187 | ~v183)) + v5 + v180 - 2054922799, 11);
	v190 = v187 + v191;
	v192 = v190;
	v194 = __ROR4__((v189 ^ (v190 | ~v186)) + v12 + v183 + 1873313359, 26);
	v193 = v190 + v194;
	v195 = v193;
	v196 = __ROR4__((v192 ^ (v193 | ~v189)) + v19 + v186 - 30611744, 22);
	v197 = v193 + v196;
	v199 = __ROR4__((v193 ^ ((v193 + v196) | ~v192)) + v10 + v189 - 1560198380, 17);
	v198 = v197 + v199;
	v200 = v198;
	v202 = __ROR4__((v197 ^ ((v197 + v199) | ~v195)) + v17 + v192 + 1309151649, 11);
	v201 = v198 + v202;
	v203 = v201;
	v205 = __ROR4__((v200 ^ (v201 | ~v197)) + v8 + v195 - 145523070, 26);
	v204 = v201 + v205;
	v206 = v204;
	v208 = __ROR4__((v203 ^ (v204 | ~v200)) + v15 + v197 - 1120210379, 22);
	v207 = v204 + v208;
	v209 = v207;
	v211 = __ROR4__((v206 ^ (v207 | ~v203)) + v6 + v200 + 718787259, 17);
	v210 = v207 + v211;
	v212 = __ROR4__((v209 ^ (v210 | ~v206)) + v13 + v203 - 343485551, 11);
	*((int *)v3 + 2) += v206;
	*((int *)v3 + 3) += v210 + v212;
	*((int *)v3 + 4) += v210;
	*((int *)v3 + 5) += v209;
	printf("\n%x,%x", v206);
	char *result1 = stringToHexString((unsigned char *)v3, 24);
	printf("\nresult:\t%s\n\n\n", result1);
	return 0;
}